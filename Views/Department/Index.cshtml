@model IEnumerable<CompanyPhonebook.Models.Department>

@{
    ViewData["Title"] = "Departments";
}

<h1>Departments</h1>

<!-- 🔍 Search Form -->
<form asp-action="Index" method="get" class="mb-3">
    <label for="searchQuery" class="visually-hidden">Search Departments</label>
    <input id="searchQuery" type="text" name="searchQuery" class="form-control d-inline-block w-auto"
           placeholder="Search departments..." value="@Context.Request.Query["searchQuery"]" />
    <button type="submit" class="btn btn-primary">Search</button>

    <!-- Create and Dashboard Buttons -->
    <a asp-action="Create" class="btn btn-success ms-2">➕ Create Department</a>
    <a asp-action="Index" asp-controller="Dashboard" class="btn btn-primary ms-2">🏠 Dashboard</a>
</form>

<!-- 📋 Responsive Card Grid for Departments -->
<div class="row">
    @if (Model.Any())
    {
        @foreach (var department in Model)
        {
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">@department.Name</h5>
                        <p class="card-text"><strong>Department Extension:</strong> @department.PhoneExtension</p>

                        <!-- Department Users -->
                        <p class="card-text"><strong>Users:</strong></p>
                        @if (department.Users != null && department.Users.Any())
                        {
                            <ul class="list-group list-group-flush">
                                @foreach (var user in department.Users)
                                {
                                    <li class="list-group-item">@user.FirstName @user.LastName</li>
                                }
                            </ul>
                        }
                        else
                        {
                            <p class="text-muted">No users assigned</p>
                        }

                        <!-- Action Buttons -->
                        <div class="d-flex justify-content-between mt-3">
                            <a asp-action="Edit" asp-route-id="@department.Id" class="btn btn-warning btn-sm">Edit</a>
                            <form asp-action="Delete" asp-route-id="@department.Id" method="post" class="d-inline">
                                <button type="submit" class="btn btn-danger btn-sm"
                                        onclick="return confirm('Are you sure you want to delete this department?');">
                                    Delete
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="col-12 text-center">
            <p class="text-muted">No departments found.</p>
        </div>
    }
</div>


<!-- CSS for Floating Buttons -->
<style>
    .fab {
        position: fixed;
        right: 20px;
        z-index: 1000;
        padding: 12px 20px;
        border-radius: 50px;
        box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease-in-out;
    }

        .fab:hover {
            transform: scale(1.1);
        }

    .create-btn {
        bottom: 80px;
        background-color: #28a745;
        color: white;
    }

    .back-btn {
        bottom: 20px;
        background-color: #007bff;
        color: white;
    }
</style>
